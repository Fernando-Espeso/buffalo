{% schema %}
{
  "name": "Buffalo-live",
  "settings": [],
  "blocks": [
    {
      "type": "item",
      "name": "Elemento",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Imagen"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Enlace"
        },
        {
          "type": "text",
          "id": "caption",
          "label": "Texto (caption)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Buffalo Live",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<div class="swiper-live">
    <div class="swiper-wrapper">
      {% for block in section.blocks %}
        {% assign img = block.settings.image %}
        {% assign link = block.settings.link %}
        {% assign caption = block.settings.caption %}
        
        <div class="swiper-slide">
          {% if link != blank %}
            <a href="{{ link }}">
          {% endif %}
          
          {% if img != blank %}
            <img src="{{ img | img_url: 'medium' }}" alt="{{ caption }}">
          {% endif %}
          
          {% if caption != blank %}
            <p class="caption">{{ caption }}</p>
          {% endif %}
          
          {% if link != blank %}
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
  
  <div class="swiper-pagination"></div>

<style>
    .swiper-pagination-bullet-active {
        opacity: black;
        background: black;
        margin:0px;
    }
    .swiper-pagination-bullet {
        margin: 0px !important;
    }
    .swiper-slide img {
        transition: transform 0.3s ease;
        cursor: pointer;
        z-index: 1;
    }
    .swiper-slide img.expanded {
        transform: scale(2);
        z-index: 10;
        position: relative;
    }
</style>
<script>
  const swiper = new Swiper('.swiper-live', {
    direction: 'horizontal',
    slidesPerView: 9.5,
    loopedSlides: 20,
    spaceBetween: 3,
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
      renderBullet: function (index, className) {
        return `<span class="${className}"></span>`;
      }
    },
  });

  // Escuchar clicks en las imágenes del swiper
  document.querySelectorAll('.swiper-live .swiper-slide img').forEach(img => {
    img.addEventListener('hover', () => {
      // Si ya está expandida, quitar la clase
      const wasExpanded = img.classList.contains('expanded');
      
      // Quitar la clase a todas
      document.querySelectorAll('.swiper-live .swiper-slide img').forEach(i => i.classList.remove('expanded'));

      // Si no estaba expandida, expandir esta
      if (!wasExpanded) {
        img.classList.add('expanded');
      }
    });
  });
</script>

